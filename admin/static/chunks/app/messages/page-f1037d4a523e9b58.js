(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[451],{1360:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},2056:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},4589:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]])},6485:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},6651:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6983:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},7586:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},7812:(e,t,s)=>{Promise.resolve().then(s.bind(s,9787))},7828:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9787:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(5155),a=s(2115),l=s(1733),i=s(6651),n=s(4589),d=s(2056),c=s(6983),o=s(7828),x=s(1360),m=s(7586),u=s(6485),h=s(5704);function g(){let[e,t]=(0,a.useState)([]),[s,g]=(0,a.useState)(!0),[p,v]=(0,a.useState)([]),[y,b]=(0,a.useState)(""),[j,N]=(0,a.useState)("all"),[f,w]=(0,a.useState)("all"),A=async()=>{try{t([{id:"1",content:"Hi! I'm interested in renting your MacBook Pro. Is it still available?",senderId:"user1",receiverId:"user2",conversationId:"conv1",isRead:!0,isReported:!1,status:"ACTIVE",createdAt:new Date().toISOString(),sender:{id:"user1",email:"buyer@brrowapp.com",username:"buyer123",firstName:"John",lastName:"Doe"},receiver:{id:"user2",email:"seller@brrowapp.com",username:"seller456",firstName:"Jane",lastName:"Smith"},listing:{id:"listing1",title:'MacBook Pro 16" M3 Max'}},{id:"2",content:"Yes it is! When would you need it?",senderId:"user2",receiverId:"user1",conversationId:"conv1",isRead:!0,isReported:!1,status:"ACTIVE",createdAt:new Date(Date.now()-36e5).toISOString(),sender:{id:"user2",email:"seller@brrowapp.com",username:"seller456",firstName:"Jane",lastName:"Smith"},receiver:{id:"user1",email:"buyer@brrowapp.com",username:"buyer123",firstName:"John",lastName:"Doe"},listing:{id:"listing1",title:'MacBook Pro 16" M3 Max'}},{id:"3",content:"This user is trying to scam me! Please help!",senderId:"user3",receiverId:"user4",conversationId:"conv2",isRead:!1,isReported:!0,status:"FLAGGED",createdAt:new Date(Date.now()-864e5).toISOString(),sender:{id:"user3",email:"reporter@brrowapp.com",username:"concerned_user",firstName:"Mike",lastName:"Johnson"},receiver:{id:"user4",email:"suspect@brrowapp.com",username:"suspicious_user",firstName:"Unknown",lastName:"User"},reports:[{id:"report1",reason:"Suspected fraud",reportedAt:new Date(Date.now()-36e5).toISOString()}]},{id:"4",content:"Thank you for the great rental experience!",senderId:"user5",receiverId:"user6",conversationId:"conv3",isRead:!0,isReported:!1,status:"ARCHIVED",createdAt:new Date(Date.now()-1728e5).toISOString(),sender:{id:"user5",email:"happy@brrowapp.com",username:"happy_customer",firstName:"Sarah",lastName:"Wilson"},receiver:{id:"user6",email:"provider@brrowapp.com",username:"great_provider",firstName:"Tom",lastName:"Brown"},listing:{id:"listing2",title:"Professional Camera Kit"}}])}catch(e){console.error("Error fetching messages:",e),t([{id:"1",content:"Hi! I'm interested in your listing.",senderId:"user1",receiverId:"user2",conversationId:"conv1",isRead:!0,isReported:!1,status:"ACTIVE",createdAt:new Date().toISOString(),sender:{id:"user1",email:"buyer@brrowapp.com",username:"buyer123",firstName:"John",lastName:"Doe"},receiver:{id:"user2",email:"seller@brrowapp.com",username:"seller456",firstName:"Jane",lastName:"Smith"}}])}finally{g(!1)}};(0,a.useEffect)(()=>{A()},[]);let k=async e=>{if(0!==p.length&&confirm("Are you sure you want to ".concat(e," ").concat(p.length," messages?")))try{for(let t of p){let s="delete"===e?"/api/admin/messages/".concat(t):"/api/admin/messages/".concat(t,"/moderate"),r="delete"===e?"DELETE":"PATCH",a="delete"!==e?{status:"approve"===e?"ACTIVE":"flag"===e?"FLAGGED":"archive"===e?"ARCHIVED":"DELETED"}:void 0;await fetch("".concat(h.env.NEXT_PUBLIC_API_URL).concat(s),{method:r,headers:{Authorization:"Bearer ".concat(localStorage.getItem("adminToken")),"Content-Type":"application/json"},body:a?JSON.stringify(a):void 0})}v([]),A()}catch(t){console.error("Error performing ".concat(e,":"),t)}},D=e.filter(e=>{var t,s,r,a;let l=e.content.toLowerCase().includes(y.toLowerCase())||(null==(t=e.sender)?void 0:t.email.toLowerCase().includes(y.toLowerCase()))||(null==(s=e.receiver)?void 0:s.email.toLowerCase().includes(y.toLowerCase()))||(null==(a=e.listing)||null==(r=a.title)?void 0:r.toLowerCase().includes(y.toLowerCase())),i="all"===j||e.status===j,n="all"===f||"reported"===f&&e.isReported||"unread"===f&&!e.isRead||"listing"===f&&e.listing;return l&&i&&n});return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-gray-950 p-6",children:(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-7xl mx-auto",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Messages Management"}),(0,r.jsx)("p",{className:"text-gray-400 mt-2",children:"Monitor and moderate platform conversations"})]})}),(0,r.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(i.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search messages...",value:y,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,r.jsxs)("select",{value:j,onChange:e=>N(e.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"All Status"}),(0,r.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,r.jsx)("option",{value:"FLAGGED",children:"Flagged"}),(0,r.jsx)("option",{value:"ARCHIVED",children:"Archived"}),(0,r.jsx)("option",{value:"DELETED",children:"Deleted"})]}),(0,r.jsxs)("select",{value:f,onChange:e=>w(e.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"All Types"}),(0,r.jsx)("option",{value:"reported",children:"Reported"}),(0,r.jsx)("option",{value:"unread",children:"Unread"}),(0,r.jsx)("option",{value:"listing",children:"Listing Related"})]})]}),p.length>0&&(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>k("approve"),className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:["Approve (",p.length,")"]}),(0,r.jsxs)("button",{onClick:()=>k("flag"),className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm",children:["Flag (",p.length,")"]}),(0,r.jsxs)("button",{onClick:()=>k("archive"),className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:["Archive (",p.length,")"]}),(0,r.jsxs)("button",{onClick:()=>k("delete"),className:"px-3 py-1 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm",children:["Delete (",p.length,")"]})]})]})}),(0,r.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl overflow-hidden",children:s?(0,r.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"}),(0,r.jsx)("span",{className:"ml-3 text-gray-400",children:"Loading messages..."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-800/50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-4 text-left",children:(0,r.jsx)("input",{type:"checkbox",checked:p.length===D.length&&D.length>0,onChange:e=>{e.target.checked?v(D.map(e=>e.id)):v([])},className:"rounded border-gray-600 bg-gray-700 text-blue-600"})}),(0,r.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Message"}),(0,r.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Participants"}),(0,r.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Status"}),(0,r.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Listing"}),(0,r.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Created"}),(0,r.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:D.map(e=>{var t,s,a,l,i,m,u,h;return(0,r.jsxs)("tr",{className:"border-t border-gray-800 hover:bg-gray-800/30",children:[(0,r.jsx)("td",{className:"p-4",children:(0,r.jsx)("input",{type:"checkbox",checked:p.includes(e.id),onChange:t=>{t.target.checked?v([...p,e.id]):v(p.filter(t=>t!==e.id))},className:"rounded border-gray-600 bg-gray-700 text-blue-600"})}),(0,r.jsx)("td",{className:"p-4 max-w-xs",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[e.isReported&&(0,r.jsx)(n.A,{className:"w-4 h-4 text-red-400 mt-1 flex-shrink-0"}),!e.isRead&&(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-white text-sm leading-relaxed",children:e.content.length>100?"".concat(e.content.substring(0,100),"..."):e.content}),e.reports&&e.reports.length>0&&(0,r.jsx)("div",{className:"mt-2 p-2 bg-red-900/20 border border-red-500/30 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 text-red-400 text-xs",children:[(0,r.jsx)(d.A,{className:"w-3 h-3"}),"Reported: ",e.reports[0].reason]})})]})]})}),(0,r.jsx)("td",{className:"p-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"From:"}),(0,r.jsx)("div",{className:"text-sm text-white",children:(null==(t=e.sender)?void 0:t.firstName)&&(null==(s=e.sender)?void 0:s.lastName)?"".concat(e.sender.firstName," ").concat(e.sender.lastName):(null==(a=e.sender)?void 0:a.username)||"Unknown"}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:null==(l=e.sender)?void 0:l.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"To:"}),(0,r.jsx)("div",{className:"text-sm text-white",children:(null==(i=e.receiver)?void 0:i.firstName)&&(null==(m=e.receiver)?void 0:m.lastName)?"".concat(e.receiver.firstName," ").concat(e.receiver.lastName):(null==(u=e.receiver)?void 0:u.username)||"Unknown"}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:null==(h=e.receiver)?void 0:h.email})]})]})}),(0,r.jsx)("td",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"ACTIVE":return"bg-green-100 text-green-800";case"FLAGGED":return"bg-red-100 text-red-800";case"ARCHIVED":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:e.status}),e.isReported&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[(0,r.jsx)(n.A,{className:"w-3 h-3 mr-1"}),"Reported"]}),!e.isRead&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,r.jsx)(c.A,{className:"w-3 h-3 mr-1"}),"Unread"]})]})}),(0,r.jsx)("td",{className:"p-4",children:e.listing?(0,r.jsx)("div",{className:"text-sm text-blue-400 hover:text-blue-300 cursor-pointer",children:e.listing.title}):(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"No listing"})}),(0,r.jsxs)("td",{className:"p-4 text-sm text-gray-400",children:[new Date(e.createdAt).toLocaleDateString(),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleTimeString()})]}),(0,r.jsx)("td",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"p-1 text-blue-400 hover:text-blue-300",title:"View Conversation",children:(0,r.jsx)(o.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{className:"p-1 text-yellow-400 hover:text-yellow-300",title:"Flag Message",children:(0,r.jsx)(n.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{className:"p-1 text-red-400 hover:text-red-300",title:"Delete Message",children:(0,r.jsx)(x.A,{className:"w-4 h-4"})})]})})]},e.id)})})]})})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,r.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Total Messages"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:e.length})]}),(0,r.jsx)(m.A,{className:"w-8 h-8 text-blue-400"})]})}),(0,r.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Flagged"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:e.filter(e=>"FLAGGED"===e.status||e.isReported).length})]}),(0,r.jsx)(n.A,{className:"w-8 h-8 text-red-400"})]})}),(0,r.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Unread"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:e.filter(e=>!e.isRead).length})]}),(0,r.jsx)(c.A,{className:"w-8 h-8 text-yellow-400"})]})}),(0,r.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Today"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:e.filter(e=>{let t=new Date;return new Date(e.createdAt).toDateString()===t.toDateString()}).length})]}),(0,r.jsx)(u.A,{className:"w-8 h-8 text-purple-400"})]})})]})]})})}}},e=>{e.O(0,[559,441,255,358],()=>e(e.s=7812)),_N_E=e.O()}]);