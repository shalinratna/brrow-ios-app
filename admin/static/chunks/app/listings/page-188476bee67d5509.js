(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{1010:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},1360:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},1454:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(5155),r=a(2115),l=a(1733),i=a(7828),n=a(6651),c=a(1761),d=a(2529),o=a(8874),x=a(1010),m=a(1360),h=a(6617),g=a(6485),u=a(5704);function y(){let[e,t]=(0,r.useState)([]),[a,y]=(0,r.useState)(!0),[p,b]=(0,r.useState)([]),[j,N]=(0,r.useState)(""),[v,f]=(0,r.useState)("all"),[A,w]=(0,r.useState)(null),k=async()=>{y(!0),w(null);try{let e=localStorage.getItem("adminToken");if(!e){w("No admin token found. Please log in again."),y(!1);return}let a=await fetch("".concat(u.env.NEXT_PUBLIC_API_URL,"/api/admin/listings"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){401===a.status?w("Authentication failed. Please log in again."):403===a.status?w("Access denied. Admin privileges required."):w("API error: ".concat(a.status)),y(!1);return}let s=await a.json();console.log("Listings API Response:",s),s.success&&s.data&&s.data.listings?(t(s.data.listings),console.log("Loaded ".concat(s.data.listings.length," real listings from database"))):Array.isArray(s)?(t(s),console.log("Loaded ".concat(s.length," real listings from database"))):w("No listings data received from API")}catch(e){console.error("Error fetching listings:",e),w("Failed to connect to backend server")}finally{y(!1)}};(0,r.useEffect)(()=>{k()},[]);let L=async e=>{if(0!==p.length&&confirm("Are you sure you want to ".concat(e," ").concat(p.length," listings?")))try{let t=localStorage.getItem("adminToken");for(let a of p)"delete"===e?await fetch("".concat(u.env.NEXT_PUBLIC_API_URL,"/api/admin/listings/").concat(a),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}):await fetch("".concat(u.env.NEXT_PUBLIC_API_URL,"/api/admin/listings/").concat(a,"/moderate"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({status:"approve"===e?"AVAILABLE":"REMOVED",reason:"reject"===e?"Administrative action":void 0})});b([]),k()}catch(t){console.error("Error performing ".concat(e,":"),t)}},E=e.filter(e=>{var t,a;let s=e.title.toLowerCase().includes(j.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(j.toLowerCase()))||(null==(a=e.user)?void 0:a.email.toLowerCase().includes(j.toLowerCase())),r="all"===v||e.availabilityStatus===v;return s&&r});return a?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-gray-950 p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"}),(0,s.jsx)("span",{className:"text-gray-400",children:"Loading real listings from database..."})]})})}):A?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-gray-950 p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-red-400 text-lg mb-4",children:["❌ ",A]}),(0,s.jsx)("button",{onClick:k,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})})}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-gray-950 p-6",children:(0,s.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Listings Management"}),(0,s.jsxs)("p",{className:"text-gray-400 mt-2",children:["Manage all platform listings • ",e.length," total listings from database"]})]}),(0,s.jsxs)("button",{onClick:k,className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white hover:bg-gray-700 flex items-center gap-2",children:[(0,s.jsx)(i.A,{className:"w-4 h-4"}),"Refresh"]})]}),(0,s.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)(n.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"Search listings...",value:j,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsx)("div",{className:"flex gap-2",children:["all","AVAILABLE","RENTED","PENDING","REMOVED"].map(e=>(0,s.jsx)("button",{onClick:()=>f(e),className:"px-3 py-1 rounded-lg text-sm font-medium transition-all ".concat(v===e?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:"all"===e?"All":e},e))}),p.length>0&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>L("approve"),className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:["Approve (",p.length,")"]}),(0,s.jsxs)("button",{onClick:()=>L("reject"),className:"px-3 py-1 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 text-sm",children:["Reject (",p.length,")"]}),(0,s.jsxs)("button",{onClick:()=>L("delete"),className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm",children:["Delete (",p.length,")"]})]})]})}),(0,s.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl overflow-hidden",children:0!==E.length||a?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-800/50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-4 text-left",children:(0,s.jsx)("input",{type:"checkbox",checked:p.length===E.length&&E.length>0,onChange:e=>{e.target.checked?b(E.map(e=>e.id)):b([])},className:"rounded border-gray-600 bg-gray-700 text-blue-600"})}),(0,s.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Listing"}),(0,s.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Price"}),(0,s.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Status"}),(0,s.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Owner"}),(0,s.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Created"}),(0,s.jsx)("th",{className:"p-4 text-left text-sm font-medium text-gray-400",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:E.map(e=>{var t,a,r,l,n,h,g;return(0,s.jsxs)("tr",{className:"border-t border-gray-800 hover:bg-gray-800/30",children:[(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("input",{type:"checkbox",checked:p.includes(e.id),onChange:t=>{t.target.checked?b([...p,e.id]):b(p.filter(t=>t!==e.id))},className:"rounded border-gray-600 bg-gray-700 text-blue-600"})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[e.images&&e.images.length>0&&(0,s.jsx)("img",{src:(null==(t=e.images.find(e=>e.isPrimary))?void 0:t.imageUrl)||e.images[0].imageUrl,alt:e.title,className:"w-12 h-12 object-cover rounded-lg"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-white",children:e.title}),(0,s.jsx)("div",{className:"text-sm text-gray-400 truncate max-w-xs",children:e.description}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[null==(a=e.category)?void 0:a.name," • ",(null==(r=e._count)?void 0:r.favorites)||0," favorites"]})]})]})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center text-green-400 font-medium",children:[(0,s.jsx)(c.A,{className:"w-4 h-4 mr-1"}),e.price]})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"AVAILABLE":return"bg-green-100 text-green-800";case"RENTED":return"bg-blue-100 text-blue-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"REMOVED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.availabilityStatus)),children:["AVAILABLE"===e.availabilityStatus&&(0,s.jsx)(d.A,{className:"w-3 h-3 mr-1"}),"REMOVED"===e.availabilityStatus&&(0,s.jsx)(o.A,{className:"w-3 h-3 mr-1"}),e.availabilityStatus]})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-white",children:(null==(l=e.user)?void 0:l.firstName)&&(null==(n=e.user)?void 0:n.lastName)?"".concat(e.user.firstName," ").concat(e.user.lastName):(null==(h=e.user)?void 0:h.username)||"Unknown"}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:null==(g=e.user)?void 0:g.email})]})}),(0,s.jsx)("td",{className:"p-4 text-sm text-gray-400",children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{className:"p-1 text-blue-400 hover:text-blue-300",children:(0,s.jsx)(i.A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{className:"p-1 text-green-400 hover:text-green-300",children:(0,s.jsx)(x.A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{className:"p-1 text-red-400 hover:text-red-300",children:(0,s.jsx)(m.A,{className:"w-4 h-4"})})]})})]},e.id)})})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-gray-400 text-lg",children:"No listings found"}),(0,s.jsx)("div",{className:"text-gray-500 text-sm mt-2",children:0===e.length?"No listings in database":"Try adjusting your search or filters"})]})})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,s.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Total Listings"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-white",children:e.length})]}),(0,s.jsx)(h.A,{className:"w-8 h-8 text-blue-400"})]})}),(0,s.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Available"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-white",children:e.filter(e=>"AVAILABLE"===e.availabilityStatus).length})]}),(0,s.jsx)(d.A,{className:"w-8 h-8 text-green-400"})]})}),(0,s.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Total Value"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-white",children:["$",e.reduce((e,t)=>e+t.price,0).toLocaleString()]})]}),(0,s.jsx)(c.A,{className:"w-8 h-8 text-green-400"})]})}),(0,s.jsx)("div",{className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-xl p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"New Today"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-white",children:e.filter(e=>{let t=new Date;return new Date(e.createdAt).toDateString()===t.toDateString()}).length})]}),(0,s.jsx)(g.A,{className:"w-8 h-8 text-purple-400"})]})})]})]})})}},1761:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},2529:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6485:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},6617:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},6651:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},7828:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8047:(e,t,a)=>{Promise.resolve().then(a.bind(a,1454))},8874:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}},e=>{e.O(0,[559,441,255,358],()=>e(e.s=8047)),_N_E=e.O()}]);